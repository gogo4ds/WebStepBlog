
@model IEnumerable<WebStepBlog.Models.Tag>

@{
    ViewBag.Title = "PostsByTag";
}

<h2>Posts</h2>

<table class="table">
    <tr>
        <th>
            Title
        </th>
        <th>
            Body
        </th>
        <th>
            Date
        </th>
        <th>
            Author
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
        foreach (var post in item.Posts)
         {
             <tr>
                 <td>
                     @Html.DisplayFor(modelItem => post.Title)
                 </td>
                 <td>
                     @Html.DisplayFor(modelItem => post.Body)
                     <div class="post-tags">
                         <h4>Tags:</h4>
                         @{
                             var tags = post.Tag.Split(new char[]{ ',', ' ' }, StringSplitOptions.RemoveEmptyEntries);
                             for (var i = 0; i < tags.Length; i++)
                             {
                                 var tag = tags[i];
                                 if (i != tags.Length - 1)
                                 {
                                     if (tag == post.Tags.First().Title)
                                     {
                                         <span class="tag single-tag"><strong>@tag</strong></span><span>, </span>
                                     }
                                     else
                                     {
                                        <span class="tag"><strong>@tag</strong></span><span>, </span>
                                     }

                                 }
                                 else
                                 {
                                     if (tag == post.Tags.First().Title)
                                     {
                                        <span class="tag single-tag"><strong>@tag</strong></span>
                                     }
                                     else
                                     {
                                        <span class="tag"><strong>@tag</strong></span>
                                     }
                                 }
                             }
                        }
                     </div>
                 </td>
                 <td>
                     @Html.DisplayFor(modelItem => post.Date)
                 </td>
                 <th>
                     @if (post.Author == null)
                     {
                         <i>No Author</i>
                     }

                     @Html.DisplayFor(modelItem => post.Author.FullName)
                 </th>
                 <td>
                     @Html.ActionLink("Edit", "Edit", new {id = item.Id}) |
                     @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                     @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                 </td>
             </tr>
         }
    }
</table>
